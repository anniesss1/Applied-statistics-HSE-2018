define(["require","exports","modules/clean/ajax","modules/core/browser","modules/clean/sharing/api/client","modules/constants/file_viewer","modules/clean/file_store/utils","modules/clean/viewer","modules/clean/react/paper/paper_log","modules/core/i18n","modules/clean/react/bubble_dropdown_v2","modules/core/notify","modules/clean/react/size_class/constants","modules/clean/react/sign_in/utils"],function(e,o,r,n,t,i,s,a,l,p,c,d,u,f){"use strict";function _(e){var o=e.file,r=e.sharedLink;return b(e)?P(o)?r?v.Button:v.Dropdown:v.Ellipsis:v.Off}function h(e){return e===v.Dropdown||e===v.Ellipsis?c.BubbleDropdownPositions.BOTTOM_LEFT:c.BubbleDropdownPositions.BOTTOM}function b(e){var o=e.file,r=e.user,t=e.sharedLink;return!!o&&((P(o)&&I.includes(i.OPEN_IN_PAPER_VARIANT)||m(o)&&"ON"===i.EMBED_TO_PAPER_FETCH_MATTE_VARIANT||g(o)&&O.includes(i.EMBED_TO_PAPER_VARIANT))&&!a.Viewer.get_viewer().is_assume_user_session&&!n.is_mobile_or_tablet()&&n.is_supported_paper_browser()&&(!r&&!!t||!!r&&!r.is_paper_disabled))}function m(e){var o=s.getExtension(e);return!!o&&L.includes(o)}function g(e){var o=s.getExtension(e);return!!o&&N.includes(o)}function P(e){var o=s.getExtension(e);return!!o&&(B.includes(o)&&e.bytes<102400)}function T(e){var o=p._("Copy to Paper");return g(e)&&(o=p._("Add to Paper doc")),o}function A(e){return m(e)?p._("Share specific pages from this file using Dropbox Paper."):p._("Collect ideas and connect all kinds of files in a single doc.")}function x(e,o){return o===u.SizeClass.Large&&(g(e)||m(e))}function k(e){return m(e)?p._("New! Share specific pages"):g(e)?p._("Bring it all together"):p._("Bring this doc to life")}function w(e){return m(e)?p._("Help others focus on what’s important by sharing specific pages from this file. Try it now in Dropbox Paper."):g(e)?p._("Add this file to a Paper doc to collect ideas and organize your thoughts."):p._("Copy to Paper and make changes or ask for feedback.")}function C(e){var o=e.file,n=e.sharedLink,t=e.contUrl,i=e.successCallback,s=e.errorCallback,a=e.extension,l=e._tk,p=e.oqa,c=e.fromModal;r.WebRequest({url:"/paper/sign_request_data",data:{path:o.file_id,sharedLink:n,cont_url:t,extension:a,_tk:l,oqa:p,fromModal:c},success:i,error:s})}function E(e){var o=e.file,r=e.user,i=e.fromModal;if(!r)return void n.redirect(f.getSignInAndContinueUrl());var a=window.open("","_blank"),c=function(e){a?n.redirect(e,a):n.redirect(e)},u=function(){a&&a.close(),d.Notify.error(p._("Can’t copy file to Paper"))},_=e.sharedLink?e.sharedLink:"",h=e.sharedLink?"shared_file_actions":"mounted_file_actions",b=s.getExtension(o);l.paperLog(l.PaperEventTypes.CTA_CLICK,{source:h,cta:"open_in_paper_button",extension:b});var m=b,g={file:o,sharedLink:_,contUrl:"/create-doc-from-dropbox-file",extension:b,successCallback:c,errorCallback:u,_tk:"dropbox_web_copy_from_previews",oqa:m,fromModal:i};if(P(o))C(g);else if(g._tk="dropbox_web_embed_from_previews",!_&&r){var T=new t.FileShareApiClient({userId:r.id});T.sharedLinkInfo({fileIdOrPath:o.file_id}).then(function(e){e?(g.sharedLink=e.url,g.contUrl="/dropbox-file-embed",C(g)):T.createSharedLink({fileIdOrPath:o.file_id}).then(function(e){g.sharedLink=e.url,g.contUrl="/dropbox-file-embed",C(g)}).catch(function(e){u&&u()})}).catch(function(e){u&&u()})}else g.contUrl="/dropbox-file-embed",C(g)}Object.defineProperty(o,"__esModule",{value:!0});var v,I=["VARIANT_A","VARIANT_B1","VARIANT_B2","VARIANT_B3","VARIANT_B4","ON"],O=["BUTTON","DROPDOWN","ELLIPSIS"],B=["docx"],L=["ppt","pptx","pptm","pps","ppsx","ppsm","odp","pdf","ai"],N=["jpg","jpeg","png","pdf","xls","xlsx","mp4","mov","pptx","ppt","zip","rar","mp3"];(function(e){e[e.Off=1]="Off",e[e.Control=2]="Control",e[e.Button=3]="Button",e[e.Dropdown=4]="Dropdown",e[e.Ellipsis=5]="Ellipsis"})(v=o.OpenInPaperButtonVariant||(o.OpenInPaperButtonVariant={})),o.getOpenInPaperButtonVariant=_,o.getCalloutPosition=h,o.shouldShowOpenInPaper=b,o.fileSupportsEmbedToPaperFetchMatte=m,o.fileSupportsEmbedToPaper=g,o.fileSupportsCopyToPaper=P,o.getCTAText=T,o.getCTATextDescription=A,o.shouldShowCTADescription=x,o.getCalloutTitle=k,o.getCalloutMessage=w,o.createPaperAccountAndRedirect=C,o.openFileInPaper=E});
//# sourceMappingURL=utils.min.js-vflrtC7Ut.map